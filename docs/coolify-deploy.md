# Деплой Sharp Optimizer на Coolify

Это руководство описывает процесс развертывания приложения Sharp Optimizer на платформе Coolify.

## Требования

1. Установленный и настроенный сервер Coolify
2. Доступ к GitHub репозиторию проекта
3. Базовые знания Docker и контейнеризации

## Шаги по деплою

### 1. Подготовка репозитория

Проект уже содержит все необходимые файлы для деплоя на Coolify:
- `Dockerfile` - инструкции для сборки Docker образа
- `docker-compose.yml` - конфигурация для запуска сервисов
- `.coolifyignore` - список файлов, которые следует игнорировать при деплое
- `.dockerignore` - список файлов, которые не должны включаться в Docker образ

### 2. Создание нового сервиса в Coolify

1. Войдите в панель управления Coolify
2. Создайте новый проект или выберите существующий
3. Нажмите "Create new service" (Создать новый сервис)
4. Выберите тип сервиса "Docker Compose"
5. Укажите репозиторий GitHub, который содержит ваш проект
6. Выберите ветку (обычно `main`)

### 3. Настройка переменных окружения

В Coolify необходимо настроить следующие переменные окружения:
- `NODE_ENV=production`
- `PORT=3000` (или любой другой порт по вашему выбору)

При необходимости добавьте другие переменные окружения, такие как:
- Переменные для подключения к базе данных
- API ключи для внешних сервисов
- Настройки безопасности

### 4. Настройка домена

1. В настройках сервиса перейдите в раздел "Domains" (Домены)
2. Добавьте домен, который будет использоваться для доступа к приложению
3. Настройте SSL/TLS сертификат (рекомендуется Let's Encrypt)

### 5. Запуск деплоя

1. Нажмите кнопку "Deploy" (Развернуть)
2. Coolify автоматически выполнит следующие действия:
   - Клонирование репозитория
   - Сборка Docker образа
   - Запуск контейнера
   - Настройка реверс-прокси для доступа к приложению

### 6. Проверка работоспособности

После успешного деплоя:
1. Проверьте логи на наличие ошибок
2. Откройте настроенный домен в браузере
3. Убедитесь, что приложение работает корректно

## Обновление приложения

Для обновления приложения достаточно отправить изменения в репозиторий и запустить повторный деплой в Coolify.

## Устранение неполадок

### Проблемы с доступом к API

Если возникают проблемы с доступом к API, проверьте:
1. Настройки CORS в файлах API
2. Правильность URL, используемых в клиентском коде
3. Настройки прокси в Coolify

### Ошибки сборки

При ошибках сборки Docker образа:
1. Проверьте логи сборки в Coolify
2. Убедитесь, что все зависимости корректно указаны в `Dockerfile`
3. Проверьте наличие необходимых системных библиотек для Sharp 